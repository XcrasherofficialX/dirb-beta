#!/usr/bin/env python
# -*- coding: utf-8 -*-

import requests
import time 
import random
from colorama import Fore, Back
import os
import socket as s

def banner():
    print(Fore.BLUE,"""
    
       /$$ /$$           /$$                         /$$$$$$ 
      | $$|__/          | $$                        /$$__  $$
  /$$$$$$$ /$$  /$$$$$$ | $$$$$$$        /$$    /$$|__/  \ $$
 /$$__  $$| $$ /$$__  $$| $$__  $$      |  $$  /$$/  /$$$$$$/
| $$  | $$| $$| $$  \__/| $$  \ $$       \  $$/$$/  /$$____/ 
| $$  | $$| $$| $$      | $$  | $$        \  $$$/  | $$      
|  $$$$$$$| $$| $$      | $$$$$$$/         \  $/   | $$$$$$$$
 \_______/|__/|__/      |_______/           \_/    |________/ 
                                                
                                                
                                                """,Fore.GREEN, 
                                                            """[created by crasher] \n\n
                                                            
                                                            
                                                            """)
banner()
target = input("target (www.example.com):") 
path = input("show path to wordlist list: ")
with open(path,"r") as f:
    content = f.readlines()
worldlists = [x.strip() for x in content]
def hata():
    print("There is a problem with the site url, please do not add 'https://' or 'http://'.")

ip = s.gethostbyname(target) # ip adresi ni
target = "http://"+target #
hedef_url = requests.get(target)    
sorgu = hedef_url.status_code
url_düzen = target[-1]

if url_düzen != "/":
    target = target+"/"


üst_dizin = []
if sorgu == 200:
    os.system("cls")
    banner()
    print("  url:",target)
    print("  ip:",ip,"\n\n\n\n\n") 
    print("  URL                                           ","  RESPONSE",)
    print("----------------------------------------------------------------------------------")
    while True:
        worldlist = random.choice(worldlists) #1
        php = target+worldlist+".php"
        html = target+worldlist+".html"
        htm = target+worldlist+".htm"
        aspx = target+worldlist+".aspx"
        dizin = target+worldlist+"/"
        ##########################
        php_get = requests.get(php)
        html_get = requests.get(html)
        htm_get = requests.get(htm)
        aspx_get = requests.get(aspx)
        dizin_get = requests.get(dizin)
        ###########################
        php_status = php_get.status_code
        html_status = html_get.status_code
        htm_status = htm_get.status_code
        aspx_status = aspx_get.status_code
        dizin_status = dizin_get.status_code
        
        print(Fore.GREEN,"[testing]>>>",php,"|",Fore.RED,php_status)
        
        if html_status != 404:
            print(Fore.GREEN,"[testing]>>>",html,"|",Fore.RED,html_status)
            
        if htm_status != 404:
            print(Fore.GREEN,"[testing]>>>",htm,"|",Fore.RED,htm_status)
        

        if aspx_status != 404:
            print(Fore.GREEN,"[testing]>>>",aspx,"|",Fore.RED,aspx_status)
        
        if dizin_status == 200:
            print(Fore.GREEN,"[testing]>>>",dizin,"|",Fore.RED,dizin_status)
            üst_dizin.append(worldlist)#2
            random_dizin = random.choice(üst_dizin)
            dizin_ust = target+random_dizin+"/"+worldlist
            dizin_ust_get = requests.get(dizin_ust)
            dizin_ust_status = dizin_ust_get.status_code
            if dizin_ust_status == 200:
                print(Fore.GREEN,"[testing]>>>",dizin_ust,"|",Fore.RED,dizin_ust_status)
                
                        


        

        worldlists.remove(worldlist)
        liste_sayı = len(worldlists)
        if liste_sayı == 0:
            print("finish!!!")
else:
    hata()

    

