import requests
import time 
import random
from colorama import Fore, Back
import os
import socket as s

def banner():
    print(Fore.BLUE,"""
    
       /$$ /$$           /$$                         /$$$$$$ 
      | $$|__/          | $$                        /$$__  $$
  /$$$$$$$ /$$  /$$$$$$ | $$$$$$$        /$$    /$$|__/  \ $$
 /$$__  $$| $$ /$$__  $$| $$__  $$      |  $$  /$$/  /$$$$$$/
| $$  | $$| $$| $$  \__/| $$  \ $$       \  $$/$$/  /$$____/ 
| $$  | $$| $$| $$      | $$  | $$        \  $$$/  | $$      
|  $$$$$$$| $$| $$      | $$$$$$$/         \  $/   | $$$$$$$$
 \_______/|__/|__/      |_______/           \_/    |________/ 
                                                
                                                
                                                """,Fore.GREEN, 
                                                            """[created by crasher] \n\n
                                                            
                                                            
                                                            """)
banner()
with open(r"C:\Users\crasher\Desktop\exploit2\worldlists.txt") as f:
    content = f.readlines()
worldlists = [x.strip() for x in content]
def hata():
    print("site url sinde sıkıntı var lütfen 'https://' yada 'http://' eklemeyin ")

target = input("target:") # url alınıyor
ip = s.gethostbyname(target) # ip adresi ni
target = "http://www."+target #
hedef_url = requests.get(target)    
sorgu = hedef_url.status_code
url_düzen = target[-1]

if url_düzen != "/":
    target = target+"/"
    
bulunan = []
if sorgu == 200:
    print("işlemler başlıyor...")
    os.system("cls")
    banner()
    print("  [url:",target,"]")
    print("  [ip:",ip,"]\n\n\n\n\n") 
    print("  URL                                                       ","  RESPONSE")
    print("----------------------------------------------------------------------------------")
    while True:
        worldlist = random.choice(worldlists)
        php = target+worldlist+".php"
        html = target+worldlist+".html"
        htm = target+worldlist+".htm"
        aspx = target+worldlist+".aspx"
        dizin = target+worldlist+"/"
        ##########################
        php_get = requests.get(php)
        html_get = requests.get(html)
        htm_get = requests.get(htm)
        aspx_get = requests.get(aspx)
        dizin_get = requests.get(dizin)
        ###########################
        php_status = php_get.status_code
        html_status = html_get.status_code
        htm_status = htm_get.status_code
        aspx_status = aspx_get.status_code
        dizin_status = dizin_get.status_code

        
        if php_status != 404:
            print(Fore.GREEN,"[ACCEPT]>>",php,Fore.RED,php_status);print("|")
            bulunan.append(worldlist)
        if html_status != 404:
            print(Fore.GREEN,"[ACCEPT]>>",html,Fore.RED,html_status);print("|")
            bulunan.append(worldlist)
            
        if htm_status != 404:
            print(Fore.GREEN,"[ACCEPT]>>",htm,Fore.RED,htm_status);print("|")
            bulunan.append(worldlist)

        if aspx_status != 404:
            print(Fore.GREEN,"[ACCEPT]>>",aspx,Fore.RED,aspx_status)
            bulunan.append(worldlist)

        if dizin_status != 404:
            print(Fore.GREEN,"[ACCEPT]>>",dizin,Fore.RED,dizin_status)
            bulunan.append(worldlist)

        worldlists.remove(worldlist)
        liste_sayı = len(worldlists)
        if liste_sayı == 0:
            print("finish!!!")



else:
    hata()

    

